model Post {
  id                String             @map("id")          @id @default(uuid()) @db.Uuid
  title             String             @map("title")       @db.VarChar(500)
  description       String?            @map("description") @db.Text
  imgUrl            String[]            @map("img_url")     @db.VarChar(500)
  isPublic          Boolean            @map("is_public")   @default(true)

  createdAt         DateTime           @map("created_at")  @default(now()) @db.Timestamptz()
  updatedAt         DateTime           @map("updated_at")  @updatedAt @db.Timestamptz()
  deletedAt         DateTime?          @map("deleted_at")  @db.Timestamptz()

  //                relation
  userId            String             @map("user_id")     @db.Uuid
  user              User               @relation(name: "ownPosts", fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  postLiked         BehaviorWithPost[]
  comments          Comment[]
  postTopics        PostTopic[]
  postRecommendPost RecommendPost[]

  numberViews Int @default(0)

  @@index([userId])
  @@index([title])
  @@map("post")
}

model BehaviorWithPost {
  id         String       @map("id")          @id @default(uuid()) @db.Uuid
  behaviorIs BehaviorType @map("behavior_is")

  createdAt  DateTime     @map("created_at")  @default(now()) @db.Timestamptz()
  updatedAt  DateTime     @map("updated_at")  @updatedAt @db.Timestamptz()

  //         relation
  userId     String       @map("user_id")     @db.Uuid
  user       User         @relation(name: "postLiked", fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  postId     String       @map("post_id")     @db.Uuid
  post       Post         @relation(fields: [postId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@unique([userId, postId])
  @@index([userId])
  @@index([postId])
  @@map("behavior_with_post")
}

model Comment {
  id          String       @map("id")         @id @default(uuid()) @db.Uuid
  content     String       @map("content")    @db.Text

  createdAt   DateTime     @map("created_at") @default(now()) @db.Timestamptz()
  updatedAt   DateTime     @map("updated_at") @updatedAt @db.Timestamptz()
  deletedAt   DateTime?    @map("deleted_at") @db.Timestamptz()

  //          relation
  userId      String       @map("user_id")    @db.Uuid
  user        User         @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  postId      String       @map("post_id")    @db.Uuid
  post        Post         @relation(fields: [postId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  repComments RepComment[]

  @@index([userId])
  @@index([postId])
  @@map("comment")
}

model RepComment {
  id        String    @map("id")         @id @default(uuid()) @db.Uuid
  content   String    @map("content")    @db.Text

  createdAt DateTime  @map("created_at") @default(now()) @db.Timestamptz()
  updatedAt DateTime  @map("updated_at") @updatedAt @db.Timestamptz()
  deletedAt DateTime? @map("deleted_at") @db.Timestamptz()

  //        relation
  userId    String    @map("user_id")    @db.Uuid
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  commentId String    @map("comment_id") @db.Uuid
  comment   Comment   @relation(fields: [commentId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index([userId])
  @@index([commentId])
  @@map("rep_comment")
}

model BlockedUser {
  id            String   @map("id")              @id @default(uuid()) @db.Uuid

  userId        String   @map("user_id")         @db.Uuid
  user          User     @relation(name: "blackList", fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  blockedUserId String   @map("blocked_user_id") @db.Uuid

  createdAt     DateTime @map("created_at")      @default(now()) @db.Timestamptz()
  updatedAt     DateTime @map("updated_at")      @updatedAt @db.Timestamptz()

  @@unique([userId, blockedUserId])
  @@index([userId])
  @@map("blocked_user")
}

enum BehaviorType {
    LIKE
    DISLIKE
}
