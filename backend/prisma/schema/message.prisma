model Message {
    id Int @id @default(autoincrement())

    content String

    senderID String? @db.Uuid
    sender   User?   @relation(fields: [senderID], references: [id], onDelete: Cascade, onUpdate: Cascade, name: "MessageSender")

    receiverID String? @db.Uuid
    receiver   User?   @relation(fields: [receiverID], references: [id], onDelete: Cascade, onUpdate: Cascade, name: "MessageReceiver")

    roomId String @db.Uuid
    room   Room   @relation(fields: [roomId], references: [id], onDelete: Cascade, onUpdate: Cascade)

    messageType String @default("text") // text, image, file
    isRead Boolean @default(false)

    createAt DateTime  @default(now())
    updateAt DateTime  @updatedAt
    deleteAt DateTime?
}

model ReadProgress {
    id        String @id @default(uuid()) @db.Uuid
    messageId Int    @default(0)

    roomId String @db.Uuid @unique

    userId String @db.Uuid
    User   User @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
}

model Room {
    id     String @id @default(uuid()) @db.Uuid
    roomId String @db.Uuid

    nameRoom String

    members  Member[]
    messages Message[]
    
    createAt DateTime  @default(now())
    updateAt DateTime  @updatedAt
}

model Member {
    id String @id @default(uuid()) @db.Uuid

    userId String @db.Uuid
    user   User   @relation(fields: [userId], references: [id], onUpdate: Cascade, onDelete: Cascade)

    roomId String @db.Uuid
    room   Room   @relation(fields: [roomId], references: [id], onUpdate: Cascade, onDelete: Cascade)
}
